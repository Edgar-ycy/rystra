# Rystraï¼ˆRust åå‘ä»£ç†å·¥å…·ï¼‰

Rystra æ˜¯ä¸€ä¸ªä½¿ç”¨ **Rust** ç¼–å†™çš„ã€**è‡ªä¸»å¯æ§ã€å¼ºå·¥ç¨‹åŒ–ã€å¯é•¿æœŸæ¼”è¿›** çš„åå‘ä»£ç†ç³»ç»Ÿã€‚

é¡¹ç›®åœ¨ **MVP é˜¶æ®µå³é‡‡ç”¨â€œä¸ºæœªæ¥æå‰æ‹†åˆ†å¤šä¸ª crateâ€** çš„ç»„ç»‡æ–¹å¼ï¼Œé€šè¿‡æ¸…æ™°çš„è¾¹ç•Œåˆ’åˆ†ã€ä¸¥æ ¼çš„ä¾èµ–è§„åˆ™å’Œæ’ä»¶åŒ–æ¶æ„ï¼Œé¿å…åœ¨åæœŸæ‰©å±•åè®®ã€ä¼ è¾“å±‚ã€å¤šè·¯å¤ç”¨ã€ç§Ÿæˆ·éš”ç¦»ç­‰èƒ½åŠ›æ—¶å‡ºç°å¤§è§„æ¨¡é‡æ„ã€‚

å½“å‰é˜¶æ®µé‡ç‚¹ç›®æ ‡ï¼š  
ğŸ‘‰ **å…ˆç¨³å®šè·‘é€š TCP åå‘ä»£ç†é—­ç¯**  
ğŸ‘‰ **å·¥ç¨‹ç»“æ„ä¸€æ¬¡æ€§è®¾è®¡åˆ°ä½**

> å½“å‰çŠ¶æ€ï¼šğŸš§ Early Development / Architecture-First

---

## âœ¨ è®¾è®¡ç›®æ ‡

- **è‡ªä¸»å¯æ§**
  - æ§åˆ¶åè®®ã€çŠ¶æ€æœºã€æ’ä»¶ä½“ç³»å®Œå…¨è‡ªç ”
  - ä¸ä¾èµ–é‡é‡çº§ RPC æ¡†æ¶
- **å·¥ç¨‹åŒ–ä¼˜å…ˆ**
  - å¤š crate æ‹†åˆ†ï¼ŒèŒè´£è¾¹ç•Œæ¸…æ™°
  - æ˜ç¡®ä¾èµ–æ–¹å‘ï¼Œé¿å…â€œæ ¸å¿ƒè…åŒ–â€
- **æ’ä»¶åŒ–æ¶æ„**
  - Proxy / Transport / Auth / Hook /ï¼ˆè§„åˆ’ï¼‰Mux å…¨éƒ¨æ’ä»¶åŒ–
  - MVP é˜¶æ®µä»…å¯ç”¨å†…å»ºæ’ä»¶
- **å¯æ¼”è¿›**
  - åè®®ç‰ˆæœ¬åŒ–
  - èƒ½åŠ›æŒ‰æ’ä»¶é€æ­¥å åŠ 
- **å¯è¿ç»´**
  - æ”¯æŒè¿è¡ŒæœŸ reloadï¼ˆæ— éœ€è‡ªåŠ¨ç›‘å¬æ–‡ä»¶ï¼‰
  - è¿æ¥çº§åˆ«å¯è§‚æµ‹æ€§

---

## ğŸ“¦ Workspace ç»“æ„ï¼ˆä¸ºæœªæ¥æå‰æ‹†åˆ†ï¼‰

> å³ä½¿åœ¨ MVP é˜¶æ®µï¼Œä¹Ÿä¿ç•™å®Œæ•´ crate éª¨æ¶  
> æœªå®ç°èƒ½åŠ›ä»¥ **å ä½ + æ–‡æ¡£çº¦å®š** çš„å½¢å¼å­˜åœ¨

```
rystra/
â”œâ”€â”€ Cargo.toml
â”œâ”€â”€ crates/
â”‚  â”œâ”€â”€ rystra-model/                # åŸºç¡€æ•°æ®ç»“æ„ã€IDã€é”™è¯¯ç ï¼ˆæœ€åº•å±‚ï¼‰
â”‚  â”œâ”€â”€ rystra-proto/                # æ§åˆ¶é¢åè®®å®šä¹‰ï¼ˆç‰ˆæœ¬åŒ–ï¼‰
â”‚  â”œâ”€â”€ rystra-plugin/               # æ’ä»¶ trait å®šä¹‰ï¼ˆProxy / Transport / Auth / Hook / Muxï¼‰
â”‚  â”œâ”€â”€ rystra-plugin-registry/      # æ’ä»¶æ³¨å†Œä¸è£…é…
â”‚  â”œâ”€â”€ rystra-core/                 # æ ¸å¿ƒçŠ¶æ€æœºã€ProxyManagerã€RuntimeController
â”‚  â”œâ”€â”€ rystra-net/                  # ç½‘ç»œå·¥å…·ï¼ˆio copyã€framingã€è¿æ¥IDï¼‰
â”‚  â”œâ”€â”€ rystra-runtime/              # è¿è¡Œæ—¶æŠ½è±¡ï¼ˆä»»åŠ¡ç®¡ç†ã€è¶…æ—¶ã€é‡è¿ï¼‰
â”‚  â”œâ”€â”€ rystra-config/               # é…ç½®åŠ è½½ã€æ ¡éªŒã€snapshot é…ç½®ç»“æ„ä½“ + æ ¡éªŒ + è¯­ä¹‰åŒ–ç±»å‹
â”‚  â”œâ”€â”€ rystra-observe/              # tracing / metrics ç»Ÿä¸€å°è£…
â”‚  â”œâ”€â”€ rystra-server/               # Server äºŒè¿›åˆ¶
â”‚  â”œâ”€â”€ rystra-client/               # Client äºŒè¿›åˆ¶
â”‚  â”œâ”€â”€ rystra-cli/                  # CLI / ç®¡ç†å·¥å…·ï¼ˆå¯é€‰ï¼‰
â”‚  â”œâ”€â”€ rystra-testkit/              # é›†æˆæµ‹è¯•å·¥å…·
â”‚  â””â”€â”€ plugins/
â”‚     â”œâ”€â”€ proxy/
â”‚     â”‚  â”œâ”€â”€ rystra-proxy-tcp/      # âœ… MVP
â”‚     â”‚  â”œâ”€â”€ rystra-proxy-http/     # è§„åˆ’
â”‚     â”‚  â””â”€â”€ rystra-proxy-udp/      # è§„åˆ’
â”‚     â”œâ”€â”€ transport/
â”‚     â”‚  â”œâ”€â”€ rystra-transport-tcp/  # âœ… MVP
â”‚     â”‚  â”œâ”€â”€ rystra-transport-tls/  # è§„åˆ’
â”‚     â”‚  â””â”€â”€ rystra-transport-quic/ # è§„åˆ’
â”‚     â”œâ”€â”€ auth/
â”‚     â”‚  â”œâ”€â”€ rystra-auth-token/     # âœ… MVP
â”‚     â”‚  â””â”€â”€ rystra-auth-mtls/      # è§„åˆ’
â”‚     â”œâ”€â”€ hook/
â”‚     â”‚  â””â”€â”€ rystra-hook-rate/      # è§„åˆ’
â”‚     â””â”€â”€ mux/
â”‚        â””â”€â”€ rystra-mux-smux/       # è§„åˆ’
```

---

## ğŸ”’ ä¾èµ–è§„åˆ™ï¼ˆå¿…é¡»éµå®ˆï¼‰

ä¾èµ–æ–¹å‘ï¼ˆè‡ªä¸‹è€Œä¸Šï¼‰ï¼š

1. `rystra-model`
2. `rystra-proto`
3. `rystra-plugin`
4. `plugins/*`
5. `rystra-core`
6. `rystra-server / rystra-client / rystra-cli`

**ç¦æ­¢è¡Œä¸ºï¼š**

- `model` ä¾èµ–ä»»ä½•ä¸Šå±‚ crate
- `proto` ä¾èµ– `core/server/client`
- æ’ä»¶ä¹‹é—´ç›´æ¥äº’ç›¸ä¾èµ–

---

## ğŸ”Œ æ’ä»¶ç³»ç»Ÿè®¾è®¡

### æ’ä»¶ç±»å‹

- **Proxy Plugin**ï¼štcpï¼ˆMVPï¼‰ã€udp/httpï¼ˆè§„åˆ’ï¼‰
- **Transport Plugin**ï¼štcpï¼ˆMVPï¼‰ã€tls/quicï¼ˆè§„åˆ’ï¼‰
- **Auth Plugin**ï¼štokenï¼ˆMVPï¼‰ã€mTLSï¼ˆè§„åˆ’ï¼‰
- **Hook Plugin**ï¼šé™é€Ÿã€å®¡è®¡ã€æ”¹å†™ï¼ˆè§„åˆ’ï¼‰
- **Mux Plugin**ï¼šå¤šè·¯å¤ç”¨ï¼ˆè§„åˆ’ï¼‰

### æ’ä»¶åŸåˆ™

- åŸºäº Trait + Registry
- ç¼–è¯‘æœŸæ³¨å†Œï¼ˆæ— åŠ¨æ€åº“åŠ è½½ï¼‰
- æ’ä»¶ä»£ç ä¸æ”¯æŒçƒ­æ›¿æ¢
- æ’ä»¶**é…ç½®**æ”¯æŒè¿è¡ŒæœŸ reload
- 

---

## ğŸ—ºï¸ Roadmapï¼ˆæŒ‰å¯äº¤ä»˜èƒ½åŠ›ï¼‰

### Phase 0ï¼šå·¥ç¨‹éª¨æ¶

- [x] Workspace + crate æ‹†åˆ†
- [ ] ä¾èµ–è§„åˆ™æ–‡æ¡£åŒ– & æ ¡éªŒ
- [ ] testkit éª¨æ¶

### Phase 1ï¼šTCP åå‘ä»£ç† MVP

- [ ] æ§åˆ¶é¢åè®®ï¼ˆHello / Auth / Heartbeat / RegisterProxy / OpenStreamï¼‰
- [ ] TCP Transport æ’ä»¶
- [ ] TCP Proxy æ’ä»¶
- [ ] Token Auth æ’ä»¶
- [ ] Server â†” Client TCP åå‘ä»£ç†é—­ç¯

### Phase 2ï¼šç¨³å®šæ€§ä¸è¿ç»´

- [ ] è¿è¡ŒæœŸ reloadï¼ˆrestart å‘½ä»¤ï¼‰
- [ ] graceful shutdown / reload
- [ ] tracing / connection_id
- [ ] è¶…æ—¶ä¸é‡è¿ç­–ç•¥

### Phase 3ï¼šæ‰©å±•èƒ½åŠ›

- [ ] TLS / QUIC
- [ ] å¤šè·¯å¤ç”¨ï¼ˆMuxï¼‰
- [ ] UDP / HTTP Proxy
- [ ] Hook æ’ä»¶é“¾
- [ ] ç§Ÿæˆ·éš”ç¦» / ACLï¼ˆè§„åˆ’ï¼‰

---

## ğŸ› ï¸ æŠ€æœ¯æ ˆ

- Rust
- tokio
- serde
- tracing
- rustlsï¼ˆè§„åˆ’ï¼‰
- quinnï¼ˆè§„åˆ’ï¼‰

---

## ğŸš§ å½“å‰çŠ¶æ€

- æ¶æ„ä¸ crate è¾¹ç•Œå·²ç¡®å®š
- è¿›å…¥ **Phase 1ï¼šTCP åå‘ä»£ç† MVP å®ç°é˜¶æ®µ**